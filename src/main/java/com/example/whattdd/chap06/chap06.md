### chap06 

# 테스트 코드의 구성 
- 상황
- 테스트 코드의 구성요소
- 외부 상황과 외부 결과

## 기능에서의 상황

- 기능은 주어진 상황에 따라 다르게 동작한다.
예: 파일에서 숫자를 읽어와 숫자의 합을 구한다, 한 줄마다 한개의 숫자를 포함한다.
노련한 개발자는 어떤 상황이 실행 결과에 영향을 줄 수 있는지 찾기 위해 노력한다. 결과에 영향을 줄 수 있는 상황을 고려하지 않고 작성한 코드는 버그를 포함할 가능성이 크다.
- 결과에 영향을 줄수있는 모든 상황을 완벽하게 찾기 어려우나 가능한 많은 예외 상황을 찾으면 비정상적인 동작을 막고 소프트웨어의 품질을 높일 수 있다.

## 테스트 코드의 구성요소 : 상황, 실행 , 결과 확인

- 상황(Given), 실행(When) , 결과(Then) 확인 세가지 요소로 테스트를 구성할 수 있다.
- 위 구조에 너무 집착하지는 말자. 모든 테스트 메서드를 이 구조로 만들어야 하는 것은 아니다. 테스트 코드를 보고 내용을 이해할 수 있으면 된다.

## 외부 상황과 외부 결과

- 상황 설정이 테스트 대상으로 국한된 것은 아니다. 외부 요인도 있다. 
- 테스트 실행할 떄마다 동일한 결과를 보장해야하는데 우연에 의해 결과가 달라지면 동일한 결과를 보장할수 없게되고 신뢰를 잃어 테스트 결과를 무시하게 만드는 요인이 된다.

## 외부 상태가 테스트 결과에 영향을 주지 않게 하기

- 테스트 코드는 한번만 실행하고 끝나지 않는다. TDD를 진행하는 동안에도 계속 실행하고 개발이 끝난 이후에도 반복적으로 테스트를 실행해서 문제가 없는지 검증한다.
- 테스트는 언제 실행해도 항상 정상적으로 동작하는 것이 중요하다. 
- 간혈적으로 실패하거나 다른 테스트 다음에 실행해야 성공한다면 결과를 믿을 수 없게되고 테스트 실패에도 무감각해지고 더 나아가 테스트를 만들지 않게 된다.

## 외부 상태와 테스트 어려움

- 상황과 결과에 영향을 주는 외부 요인은 파일, DBMS, 외부서버 등 다양하다.
외부 환경을 테스트에 맞게 구성하는 것이 항상 가능한 것은 아니다.
- 외부 요인이 관여할 경우 대역을 사용하면 테스트 작성이 쉬워진다.
- 대역은 테스트 대상이 의존하는 대상의 실제 구현을 대신하는 구현인데 이 대역을 통해 외부 상황이나 결과를 대체 할 수 있다.